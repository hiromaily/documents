# キャッシュヒット率 / Cache Hit Rate

キャッシュは、データの読み書きを高速化するために使用される高性能なメモリ領域。キャッシュメモリは通常、メインメモリ(RAM)よりも小さく、プロセッサに近い場所に配置される。キャッシュの主な目的は、頻繁にアクセスされるデータをプロセッサに素早く提供すること。
キャッシュヒット率とは、キャッシュメモリへのアクセスに成功した割合を示す指標。

- キャッシュヒット数とは、プロセッサがキャッシュメモリにデータを要求して、実際にキャッシュメモリ内にデータが見つかった回数。
- キャッシュアクセス総数とは、プロセッサが全てのキャッシュメモリアクセスを試みた回数。この中にはキャッシュヒットだけでなく、キャッシュミス（キャッシュ内にデータが見つからず、メインメモリからデータを取得する必要があった場合）も含まれる。

高いキャッシュヒット率はシステムの性能向上に寄与する。なぜなら、キャッシュからデータが取得できることでメインメモリへの遅いアクセスを避けられるため。逆に、キャッシュヒット率が低いと、頻繁にメインメモリやその他の低速ストレージにアクセスする必要が生じ、全体的な性能が低下する。

## 計算

### キャッシュヒット率

`キャッシュヒット数をキャッシュヒット数とキャッシュミス数の合計で割ったもの`

### 平均アクセス時間の計算式

```txt
(キャッシュメモリのアクセス時間*ヒット率) + 主記憶のアクセス時間*(1-ヒット率)
```

## キャッシュヒット率を向上させる

1. **ローカリティの利用**:
    - **時間的局所性（Temporal Locality）**: 最近アクセスされたデータが再びアクセスされる可能性が高いという特性。特定のデータを頻繁に利用する場合、そのデータをキャッシュに保持する。
    - **空間的局所性（Spatial Locality）**: あるデータがアクセスされる際に、その近くのデータもアクセスされる可能性が高いという特性。データのアクセスパターンを考慮して、関連するデータをまとめてキャッシュに保持する。

2. **キャッシュサイズの調整**:
    - 必要に応じてキャッシュメモリのサイズを増やすことで、高頻度でアクセスされるデータをより多くキャッシュに保持できるようにする。

3. **キャッシュのアルゴリズムの最適化**:
    - データの置き換えアルゴリズム（LRUやLFUなど）の選定や調整により、キャッシュヒット率を改善する。

4. **プログラムのデータアクセスパターンの最適化**:
    - プログラムのデータアクセスパターンを分析し、キャッシュに優しいアクセス方法を設計する。

このように、キャッシュヒット率はシステム性能に重要な指標であり、適切な方法で管理することが求められる。

## References

- [キャッシュヒット率が1%変わるとどうなる？](https://zenn.dev/hmarui66/articles/4c4559f53998cd)
