# HTTP Header `Targeted Cache-Control`

標準的な`Cache-Controlヘッダ`フィールドの拡張性能を提供する新しい機能であり、特定のキャッシュ対象に対して個別の指示を行う設定をサポートする。Targeted Cache-Control は、特定のキャッシュサーバーやプロキシに対して異なるキャッシュポリシーを指示することが可能で、よりきめ細かいキャッシュ制御が実現できる。

## 基本概念

従来の Cache-Control ヘッダは主にブラウザやキャッシュサーバー全体に対して一定のキャッシュポリシーを適用するものだった。しかし、Targeted Cache-Control はキャッシュサーバーごとに異なるポリシーを設定することが可能。

## 主なフィールド

Targeted Cache-Control ヘッダは、対象のキャッシュサーバーやプロキシに対して直接的な指示を行うための構文を用いて表現される。
以下にその基本的なフィールド例を示す：

- **Cache-Control: no-store** - このヘッダは、レスポンスをどのクライアント、プロキシ、またはキャッシュでも保存しないことを指示する。
- **Cache-Control: max-age=3600** - レスポンスを最大 3600 秒間キャッシュすることを指示する。

Targeted Cache-Control の場合、これをターゲット別に明示する形になります。

## `Targeted Cache-Control`の使用例

ターゲットキャッシュに対する具体的な指示は、特定のキャッシュサーバー名を条件に含むことができる。以下はその一連の使用例：

1. **ブラウザキャッシュに特化した設定**：

   ```txt
   Cache-Control: private, max-age=3600
   ```

   これは、レスポンスがユーザーのブラウザだけにキャッシュされ、最大 3600 秒間保存されることを示す。

2. **プロキシサーバーキャッシュに特化した設定**：

   ```txt
   Cache-Control: s-maxage=86400, max-age=3600
   ```

   これは、プロキシキャッシュサーバーがレスポンスを 86400 秒間（1 日）保存し、ユーザーブラウザに対しては最大 3600 秒間保存するよう指示する。

3. **特定のサーバーに対する指示（ターゲット指定）**：

   ```txt
   Cache-Control: no-store, private, proxy-1; max-age=3600, proxy-2; no-store
   ```

   この例では、レスポンスが一時保存されず、一部の指定されたプロキシサーバーに対して異なるポリシーを指示している。
   - 全体: no-store
   - 特定の`proxy-1に対して`: max-age=3600
   - 特定の`proxy-2に対して`: no-store

## 実際の運用

Targeted Cache-Control ヘッダは、特に複数のキャッシュ層を運用する大規模システムにおいて非常に有効。具体的なキャッシュポリシーを異なるキャッシュポイントで適用することにより、高いパフォーマンスと効率的なリソース利用を実現する。

また、ターゲットとなるキャッシュサーバーは現場のアーキテクチャに応じて個別に指定する必要があり、それに対する適切なパフォーマンステストやデプロイメントも行うことが望まれる。

ターゲットキャッシュパラメータを利用することにより、キャッシュ管理の柔軟性が向上し、特定のリクエストパターンやユーザービヘイビアに対応しやすくなる。
