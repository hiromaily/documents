# どのようなケースでAWS Lambdaを使うべきか？

独立したバッチプログラムをCronジョブで実行すべきケースとの違いについて

`短時間で頻繁に実行されるタスクはLambda`で、`長時間または複雑な依存関係があるタスクはCronジョブ`で

## AWS Lambdaを使うべきケース

1. **短時間のタスク**: Lambdaは基本的に短時間の処理に向いている。最大実行時間は15分だから、それ以内で完了するタスクが適している。
2. **イベント駆動型の処理**: S3へのファイルアップロードやDynamoDBのテーブルに変更があった場合など、特定のイベントに応じて処理を実行したい場合には向いている。
3. **スケーラビリティ**: 突発的な負荷に対して自動でスケールアップ・ダウンが可能なので、リクエストの増減に対応しやすい。
4. **コスト効率**: 実行時間に応じた課金だから、頻度が低いタスクの場合にはコストが抑えられる。
5. **管理の手間が少ない**: インフラの管理が不要で、デプロイも簡単なため、管理や運用の労力が少ない。

## 独立したバッチプログラムをCronジョブで実行すべきケース

1. **長時間のタスク**: 長時間にわたる処理が必要な場合（例えばバックアップや大規模データの処理など）は、Lambdaだと制約があるため適していない。
2. **固定スケジュールでの実行**: 毎日決まった時間に実行するような定期的なバッチ処理にはCronジョブが向いている。
3. **複雑な依存関係**: 他のシステムやサーバーとの複雑な依存関係がある場合、Lambdaよりも専用サーバー上でのバッチ処理の方が扱いやすい場合がある。
4. **リソース利用の自由度**: CPUやメモリの使用量が大きいタスクや、特定のハードウェアが必要な場合には、自由にリソースを設定できる独立したバッチプログラムが適している。

## AWS Lambdaに適した短時間の基準

### おおよその目安

- **数秒から数分**: 一般的には数秒から数分以内に完了するタスクに適している。例えば、簡単なデータベースクエリや、ファイルのフォーマット変換、通知の送信など。

### 詳細

- **最大実行時間**: AWS Lambdaの最大実行時間は`15分（900秒）`。そのため、タスクがこれを超える可能性がある場合は、Lambdaの利用は適していない。
- **瞬間的な負荷対応**: 突発的な負荷にも即応できるため、リクエストが一時的に増えるようなウェブアプリケーションのバックエンド処理などにも向いている。

### 具体的な利用シナリオ

1. **データ処理**: 小規模なデータセットのフィルタリング、集計、変換など。
2. **イベント駆動のタスク**: S3にファイルがアップロードされたときの処理、DynamoDBのトリガー、SNS通知の処理。
3. **APIバックエンド**: API Gatewayと連携して、クエリの処理や簡単なビジネスロジックの実装。
4. **リアルタイム処理**: クラウドウォッチイベントやKinesisストリームからのリアルタイムデータ処理。

### 注意点

- **リトライ制御**: 一部の処理が失敗する可能性があるタスクに関しては、Lambdaのリトライ機能（失敗時の自動再試行）も活用できる。
- **分割して実行**: 長時間処理が必要なタスクでも、タスクを細かく分割して連続実行すれば、Lambdaを利用できる場合もある。
