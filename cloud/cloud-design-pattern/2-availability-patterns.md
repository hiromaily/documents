# Availability Patterns

Availability Patterns（可用性パターン）はシステムが障害やダウンタイムから迅速に回復し、高い可用性を維持するための設計パターンであり、クラウド環境では、これらのパターンを活用してシステムの信頼性と耐障害性を高めることが重要。

以下は主要な可用性パターンの概要と詳細

## 1. **Failover（フェイルオーバー）**

### a. **Active-Passive Failover（アクティブ-パッシブフェイルオーバー）**

- **概要**: プライマリリソース（アクティブ）が障害を起こした際に、待機中のバックアップリソース（パッシブ）に自動的に切り替える手法。
- **適用シナリオ**: データベースサーバーやファイルストレージ、単一障害点(single point of failure)となるリソース。
- **実装例**: AWS RDS のマルチ AZ 配置、クラシックなデータベースクラスタリング。
- **利点**: 高可用性を実現しながら、コストを削減できます（パッシブリソースは通常待機中）。
- **課題**: フェイルオーバーの切り替え時間がかかる場合がある。

### b. **Active-Active Failover（アクティブ-アクティブフェイルオーバー）**

- **概要**: 複数のアクティブリソース間でトラフィックを分散し、一方の障害時にもう一方が自動的に処理を引き継ぐ手法。
- **適用シナリオ**: ウェブサーバーやアプリケーションサーバー、ロードバランシングが可能なリソース。
- **実装例**: GlusterFS の分散ファイルシステム、ロードバランサを使った複数リソースの運用。
- **利点**: フェイルオーバーの切り替え時間がほぼゼロで、高い可用性を実現できる。
- **課題**: システム全体のコストが増加し、複雑性が増す。

## 2. **Multi-Region Deployment（マルチリージョンデプロイメント）**

- **概要**: 同じサービスを複数の地理的リージョンにデプロイし、リージョンの障害や地理的な断絶に対する耐性を高める手法。
- **適用シナリオ**: グローバルなユーザーベースを持つサービスや、リージョン単位での障害が許容されないシステム。
- **実装例**: AWS Global Accelerator、Google Cloud Spanner。
- **利点**: リージョン単位の障害に対しても高い可用性を維持し、地域ごとの性能向上が可能。
- **課題**: デプロイと管理が複雑化し、データの一貫性確保が難しくなる。

## 3. **Auto Recovery（オートリカバリー）**

- **概要**: インスタンスレベルでの障害を自動的に検出し、再起動や置き換えを行う手法。
- **適用シナリオ**: シングルポイントの VM やコンテナ、クリティカルなワークロード。
- **実装例**: AWS EC2 の Auto Recovery、Kubernetes の Pod 自動再起動機能。
- **利点**: 人手をかけずに迅速に障害から回復できる。
- **課題**: 再起動や置き換えにかかる時間により、短期間のダウンタイムが発生する可能性がある。

## 4. **Redundancy（冗長性）**

- **概要**: 複数のリソースを冗長化し、いずれかが障害を起こした場合でもシステムが継続的に動作するようにする手法。
- **適用シナリオ**: 高信頼性が必要なシステム全般。
- **実装例**: RAID アレイによるディスク冗長化、AWS の S3 データ冗長化オプション。
- **利点**: 単一リソースの障害が全体のシステムに影響しないため、信頼性が向上する。
- **課題**: コストが増加し、管理の複雑性が増す。

## 5. **Circuit Breaker（サーキットブレーカー）**

- **概要**: 連鎖的な障害を防ぐために、特定の条件を満たした場合にサービスや機能を一時的に停止する手法。
- **適用シナリオ**: マイクロサービスアーキテクチャにおけるサービス間通信。
- **実装例**: Netflix Hystrix、Spring Cloud Circuit Breaker。
- **利点**: 連鎖的な障害拡大を防ぎ、システムの安定性を向上させる。
- **課題**: サーキットブレーカーの設定が適切でないと、サービスの過剰停止や復旧遅延が発生する可能性がある。

## 6. **Health Check（ヘルスチェック）**

- **概要**: 定期的にリソースの状態を確認し、異常が検出された場合に適切な対処を行う手法。
- **適用シナリオ**: ロードバランサを使用するウェブアプリケーション、マイクロサービス。
- **実装例**: Kubernetes の Liveness Probe と Readiness Probe、AWS ELB のヘルスチェック。
- **利点**: リアルタイムでリソースの健全性を監視し、迅速な故障対応が可能。
- **課題**: 適切なヘルスチェックの設計が求められるため、実装が複雑になる場合がある。

## 7. **Backup and Restore（バックアップとリストア）**

- **概要**: データの定期的なバックアップと、そのバックアップからの迅速なリカバリーを行う手法。
- **適用シナリオ**: データベースやファイルシステム、重要なデータを保持するシステム。
- **実装例**: AWS Backup、Azure Backup、Google Cloud Storage のバージョン管理。
- **利点**: データの喪失に対する保険となり、システム障害やセキュリティ侵害時に迅速な回復が可能。
- **課題**: バックアップのスケジュール設定や保管、リストアテストの実行が必要。
