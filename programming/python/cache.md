# Cache

## `__pycache__`

`__pycache__`は、Python プログラムの効率化と速度向上に役立つディレクトリ。Python のソースコード（.py ファイル）を実行する際、インタープリタがそのソースコードを一度コンパイルしてバイトコード（.pyc ファイル）に変換する。このバイトコードにより、以降の実行時にプログラムの読み込みや開始の処理が速くなる。

**利点**:

1. **実行速度の向上**: ソースコードのコンパイルを毎回行う必要がなくなるため、プログラムの起動が速くなる。
2. **効率的な再利用**: ソースコードに変更がない場合、既存のバイトコード（キャッシュ）を再利用することで無駄なコンパイルを避ける。

`__pycache__`ディレクトリ内には、Python のバージョン情報を含む名前でバイトコードファイルが保存される。例えば、Python のバージョンが 3.9 の場合、モジュール`example.py`に対するバイトコードファイルは`example.cpython-39.pyc`のようになる。

このキャッシュディレクトリは Python が自動的に管理するため、開発者が通常直接関与する必要はない。ただし、不必要に蓄積されたキャッシュをクリーンアップするために削除することも可能。

### pycache の削除 shell script

```sh
# `.venv`を除外する例
find . -type d -name '.venv' -prune -o -type d -name '__pycache__' -exec rm -r {} + -print
```

## python のコンパイル

### プログラムからコンパイルする

`py_compile`および`compileall`というモジュールが標準ライブラリに含まれている。

- **py_compile モジュール**: 個別の Python ファイルをコンパイルするために使用される
- **compileall モジュール**: ディレクトリ全体やパッケージの全ての Python ファイルを一度にコンパイルする

### コマンドラインからのコンパイル方法

```sh
python -m py_compile your_script.py

python -m compileall your_directory
```

## `egg-info`ディレクトリ

`egg-info`ディレクトリは、Python のパッケージ管理システムによって生成される`メタデータフォルダ`で、通常はパッケージのビルドやインストール時に作成される。具体的には、Python のパッケージ管理ツールである`setuptools`によって作成される。

### `egg-info`ディレクトリの内容

1. **PKG-INFO**:
   - パッケージの名前、バージョン、著者、ライセンス、依存関係などのメタデータが記載されている。
2. **SOURCES.txt**:
   - パッケージに含まれる全てのソースファイルのリストが記載されている。
3. **dependency_links.txt**:
   - 依存するパッケージのダウンロードリンクが記載されている。
4. **top_level.txt**:
   - パッケージのトップレベルモジュールやパッケージの名前がリストされている。
5. **namespace_packages.txt**:

   - ネームスペースパッケージに関する情報が記載されている。

6. **entry_points.txt**:
   - パッケージが提供するスクリプトやプラグインなどのエントリーポイントが記載されている。

`egg-info`ディレクトリが作成されるタイミングは、主に以下の操作を行うとき：

- `python setup.py install`
- `python setup.py develop`
- `python setup.py bdist_egg`（バイナリパッケージを作成）

### `egg-info`と`dist-info`

近年では、特に`pip`と`wheel`といったツールが一般的には`egg-info`の代わりに`dist-info`ディレクトリを使用している。`dist-info`は`PEP 376`および`PEP 427`で定義されており、モダンな Python パッケージの標準に準拠したメタデータフォルダ。

### 削除しても問題ないか？

通常、`egg-info`ディレクトリはメタデータの一時保存やキャッシュとして使用されるで、必要がない場合や問題が発生する場合は削除しても問題ない。ただし、場合によっては再度インストールが必要になる。
