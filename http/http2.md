# HTTP/2

HTTP/2 は、HTTP/1.1 の後継プロトコルであり、Web のパフォーマンスを向上させるために設計された。
HTTP/2 は主に Web のパフォーマンスを向上させるために設計されており、特にリッチなコンテンツを提供するサイトや Web アプリケーションでその効果を発揮する。

## 主な特徴

1. **バイナリプロトコル**

   - HTTP/2 はテキストベースの HTTP/1.1 とは異なり、バイナリプロトコル。これにより、解析や実装が容易になり、効率的な通信が可能となる。

2. **マルチプレキシング**

   - 一つの TCP 接続で複数のリクエストとレスポンスを同時に送信できる。これにより、同時並行的なリクエストの処理が可能となり、ページの読み込み時間が大幅に短縮される。

3. **ヘッダ圧縮**

   - HPACK という圧縮手法を使用して、ヘッダフィールドを効率よく圧縮する。これにより、ヘッダサイズが小さくなり、データ通信のオーバーヘッドが減る。

4. **サーバープッシュ**

   - サーバーがクライアントの要求を待たずに、複数のリソースをプッシュ送信できる機能。この機能により、クライアントが必要とするリソースをあらかじめ送信することで、ページの読み込み速度が向上する。

5. **ストリーム優先制御**
   - クライアントは、重要なリソースのストリームに対して優先順位を設定できる。これにより、必要なリソースがより早く取得され、ページの表示が最適化される。

## 利点

1. **パフォーマンス向上**
   - マルチプレキシングにより、一つの TCP 接続で多くのリクエストを同時に処理できるため、ネットワークレイテンシを減少させる。
2. **効率の良いデータ転送**

   - ヘッダ圧縮とバイナリプロトコルは効率的なデータ転送を実現し、帯域幅の使用を最小化する。

3. **セキュリティ**
   - HTTP/2 は TLS を推奨しており、HTTPS 接続を使用することでセキュアな通信が行われる。

### 使用例

- **Web ブラウジング**

  - 大量の画像やスクリプト、スタイルシートなど多くのリソースを含む Web ページを高速にロードするために有効。

- **API 通信**
  - マイクロサービス間やモバイルデバイスとの API 通信において、効率的なデータ転送が望まれる。

## Web サーバーで HTTP/2 を使うためには？

Web サーバーで HTTP/2 を使うためには、以下のステップを踏む必要があります。以下で詳細に説明します。

### 1. サーバーの対応確認

まず、使用している Web サーバーソフトウェアが HTTP/2 をサポートしている必要がある。

- **Apache HTTP Server**: バージョン 2.4.17 以降で `mod_http2` モジュールを使用
- **Nginx**: バージョン 1.9.5 以降で HTTP/2 をサポート
- **IIS (Microsoft Internet Information Services)**: Windows Server 2016 以上でサポート
- **LiteSpeed**: デフォルトで HTTP/2 をサポート

### 2. 必要なソフトウェアのインストールと設定

特定の Web サーバーで HTTP/2 を使用するための設定を行う。

#### Apache HTTP Server

1. **HTTP/2 モジュールの有効化**:

   - Apache が HTTP/2 モジュールをサポートしていることを確認。`mod_http2` がロードされているか確認する。

     ```sh
     a2enmod http2
     ```

2. **仮想ホスト設定の更新**:

   - 仮想ホスト設定に次のようなディレクティブを追加する。

     ```xml
     <VirtualHost *:443>
         Protocols h2 http/1.1
         # Other configurations...
     </VirtualHost>
     ```

3. **TLS/SSL の設定**:

   - HTTP/2 は TLS/SSL を強く推奨する。SSL 証明書がインストールされていることを確認する。

4. **Apache 再起動**:
   - 設定変更を反映させるため、Apache を再起動する。

     ```sh
     sudo systemctl restart apache2
     ```

#### Nginx

1. **HTTP/2 の有効化**:

   - Nginx の設定ファイル（通常は `/etc/nginx/nginx.conf` または `/etc/nginx/sites-available/default`）を編集し、`listen` ディレクティブに `http2` を追加する。

     ```nginx
     server {
         listen 443 ssl http2;
         server_name example.com;

         ssl_certificate /path/to/your/cert.pem;
         ssl_certificate_key /path/to/your/key.pem;

         # Other configurations...
     }
     ```

2. **Nginx の再起動**:
   - 設定変更を反映させるため、Nginx を再起動する。

     ```sh
     sudo systemctl restart nginx
     ```
