# HTTP/3

## HTTP/3 の特徴

1. **QUIC プロトコルの使用**

   - HTTP/3 は、UDP ベースの新しいトランスポートプロトコルである `QUIC（Quick UDP Internet Connections）`プロトコルを使用している。これにより、HTTP/2 で使用されていた TCP の欠点を克服する。

2. **接続の 0-RTT ハンドシェイク**

   - QUIC は、TLS 1.3 の機能を統合し、0-RTT（Zero Round-Trip Time）での接続を確立できるため、新しい接続の遅延を大幅に削減する。

3. **ヘッダ圧縮の改良**

   - HTTP/3 は、HTTP/2 のヘッダ圧縮方式である HPACK の改良版である QPACK を使用する。これにより、ヘッダ圧縮とその処理性能が向上する。

4. **マルチプレクシングとストリーム管理**
   - HTTP/3 は、HTTP/2 のマルチプレクシングと同様に、単一の接続上で複数のストリームを並行して処理する。ただし、QUIC プロトコルを用いることで、単一ストリームのパケットロスが他のストリームに影響を与えないように設計されている。

## HTTP/3 の利点

1. **高速接続確立**

   - QUIC の 0-RTT 接続により、新しい接続が瞬時に確立できるため、初回接続の遅延が減少する。

2. **リカバリの高速化**

   - QUIC は、パケット単位でのリトランスミッションをサポートしており、パケットロス時に TCP よりも高速に回復できるため、エンドユーザーへの影響が少なくなる。

3. **輻輳制御の改良**

   - QUIC は、高度な輻輳制御アルゴリズムを内蔵しており、ネットワークの状態に応じて効率的にデータ転送を管理する。

4. **移動性の向上**
   - QUIC は、接続 ID を使用することで、IP アドレスが変更された場合でもセッションを維持できるため、移動中のデバイスでも途切れない通信が可能となる。

## 使用例

- **Web ブラウジング**
  - HTTP/3 は、ページの初回ロードを高速化するため、ユーザーエクスペリエンスが向上する。
- **ストリーミングサービス**
  - 高速なパケットリカバリと効率的なデータ転送により、映像や音楽のストリーミング品質が向上する。

## 実装方法

### サーバー側の設定

HTTP/3 を有効にするためには、まずサーバー側で QUIC と HTTP/3 をサポートする必要がある。以下に一般的な Web サーバーでの設定手順を示す。

#### Nginx

Nginx で HTTP/3 を有効にするための手順：

1. **Nginx の最新版をインストール**:
   QUIC と HTTP/3 をサポートするバージョンの Nginx をインストールする。標準の Nginx ディストリビューションではサポートされていないため、独自にビルドする必要がある場合がある。

2. **設定ファイルの編集**:
   Nginx の設定ファイルを編集し、HTTP/3（QUIC）を有効にする。

   ```nginx
   server {
       listen 443 ssl http2;
       listen 443 http3 reuseport; # HTTP/3 のためのリスニングポート
       ssl_certificate /path/to/your/cert.pem;
       ssl_certificate_key /path/to/your/key.pem;

       add_header alt-svc 'h3-23=":443"; ma=86400'; # HTTP/3の広告

       # その他の設定...
   }
   ```

3. **Nginx の再起動**:
   設定を反映させるため、Nginx を再起動する。

   ```sh
   sudo systemctl restart nginx
   ```

#### その他のサーバー

- **Cloudflare**や**CDN プロバイダー**を利用する場合、Web インターフェースから HTTP/3 を有効にすることができる。
- **LiteSpeed Web Server**や**Caddy**も HTTP/3 をサポートしており、それぞれのドキュメントに従って設定が可能。

## HTTP/3 の将来性

HTTP/3 は、Web 通信の効率化とスピード向上のための次世代プロトコルとして非常に有望。QUIC をベースにすることで、TCP の制約を超えたパフォーマンス向上を実現しており、今後ますます普及していくと予想される。Web 技術者やエンジニアは、この新しいプロトコルに早くから対応することで、ユーザーエクスペリエンスの向上やサービスの信頼性向上を実現することができる。

## References

- [2020: TCPが遅すぎる？QUICを使おう！](https://medium.com/nttlabs/quic-with-rust-9cf9b44596ad)
