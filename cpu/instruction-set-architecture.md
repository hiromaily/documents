# 命令セットアーキテクチャ（Instruction Set Architecture, ISA）

コンピュータシステムのハードウェアとソフトウェアの間の抽象的なインターフェースを定義するもので、特にプロセッサが実行できる命令の集合とその機能を指す。ISAは、プログラムが実行される際にハードウェアがどのように動作するかを規定し、基本的な命令の種類、演算、データタイプ、レジスタセット、メモリアクセス方法、入出力操作といった要素が含まれる。

## 主要な要素

1. **命令形式**：命令のビット配列の形式を決定する。これには、オペコード（操作コード）、ソースオペランド、デスティネーションオペランドなどが含まれる

2. **データタイプ**：整数、浮動小数点、文字列、ビットフィールドなど、どのような種類のデータを扱うかを定義する

3. **アドレッシングモード**：命令がメモリやレジスタ内のデータにアクセスする方法を決定する

4. **レジスタセット**：プロセッサが持つ汎用レジスタや特定用途向けレジスタの数と種類。

5. **命令の種類**：算術演算（加算、減算など）、論理演算（AND、OR、XORなど）、データ移動（ロード、ストア、移動など）、制御フロー（ジャンプ、コール、リターンなど）に関連する命令を含む

6. **例外と割り込み**：例外処理や割り込みに対応するためのメカニズム。

ISAは、コンピュータアーキテクチャの「契約書」とも言え、これに従ってソフトウェアを記述することで、ソフトウェアがハードウェアに対してどのように動作するかを明確に定義する。いくつかの代表的なISAには、x86（Intel, AMD）、ARM、MIPS、RISC-Vなどがある。

ISAは、プロセッサの性能、エネルギー効率、プログラムの互換性などに大きな影響を与えるため、非常に重要な役割を果たす。

## CPU アーキテクチャの種類

### よく見かけるのは、

- x86
- x64
- x86_64
- amd64
- arm
- arm64 (IntelMac の場合、`uname -m`で確認できる)

### 命令セット

- `x86`, `x64` は CISC(Complex Instruction Set Computer) と呼ばれる命令セット
- `arm` は RISC(Reduced Instruction Set Computer) と呼ばれる命令セット

### ビット数

- `x86` は 32bit
- `x64` は 64bit

### 開発会社

- `x86`, `x64` は、インテル社、AMD 社が開発
- `arm` は Arm 社が開発
- `amd` は Advanced Micro Devices 社

### 確認方法

```sh
uname -m
```

## `exec format error`エラー

これは多くの場合、実行しようとしているバイナリがその実行環境(OSの違いなど)と互換性がないことを示している

例えば、　AWS Lambdaは`x86_64`もしくは`arm64`アーキテクチャの環境(Linux)で動作する。したがって、実行しようとしているバイナリが異なるアーキテクチャ（e.g. ARM、x86（32ビット）、あるいは別のOS用）でコンパイルされている場合、このエラーが発生する
