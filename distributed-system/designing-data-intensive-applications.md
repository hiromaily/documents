# データ指向アプリケーションデザイン

[Oreilly: データ指向アプリケーションデザイン - 信頼性、拡張性、保守性の高い分散システム設計の原理 (2017)](https://www.oreilly.co.jp/books/9784873118703/)

原書のタイトル：`Designing Data-Intensive Application`  
これを直訳すると、`データ集約型アプリケーションの設計`となる

## データ指向アプリケーションデザインとは

- `データ指向`はこの本で定義された新しい訳語
- データ指向とは、`データの量`、`複雑さ`、`変化の速度`を中心に考えるデザインであり、「`データの量`、`複雑さ`、`変化の速度`」に対応できるシステム設計

## データの種類

### テキストフォーマット

- CSV, JSON, XML

### バイナリフォーマット

- MessagePack
- ProtocolBuffers
- Thrift
- Apache Avro

## データを作る場合、何を考慮するか

### データが少ない場合

- `データの表現`、`生成しやすさ`が重視される

### データが多い場合

- データ基盤では、`省メモリ`、`圧縮しやすさ`、`ストレージへの格納しやすさ`が重視される
- テーブルフォーマット
  - スキーマとレコード表現を分離
    - カラム名、型の情報を繰り返して出力しない分、コンパクト
- 行指向(row-oriented)フォーマット
  - RDBMS でよく使われる
  - 1 レコード ずつ表現
  - レコード単位で更新しやすい
- 列指向(column-oriented)フォーマット
  - 列(カラム)
  - 同じ型のデータを集めると圧縮しやすい
  - 分析クエリ向き
    - Cache に乗りやすく高速
    - SIMD 演算も活用しやすい
  - 一方、単一レコードの更新は大変

## 列指向データフォーマット (Columnar Format)

- [Apache Parquet](https://parquet.apache.org/)
  - ネストして繰り返しのあるデータでも、同じパスごとに分解、圧縮する
  - Spark, DuckDB などでサポート
