# 負荷テスト / Load Testing

負荷テストは、ソフトウェアシステムに特定の条件（通常はユーザー数やリクエスト数）を加えて、そのシステムが処理能力やパフォーマンスをどのように維持するかを評価するための試験。これはソフトウェアのパフォーマンスを事前に確認し、実稼働時に発生するパフォーマンス問題を未然に防ぐために実施される。
負荷テストはシステムの信頼性とパフォーマンスを向上させるために欠かせないプロセスであり、しっかりとした計画と実施、そして結果からのフィードバックを行うことが重要。

## 負荷テストの目的

1. **パフォーマンスの測定**：システムが高負荷の状態でどれだけのパフォーマンスを発揮できるかを確認する。
2. **ボトルネックの特定**：CPU、メモリ、ディスク、ネットワーク、データベースなどのリソースがどこで限界に達するかを調査する。
3. **スケーラビリティの評価**：システムが増加する負荷に対してどれだけスケールできるか確認する。
4. **安定性の評価**：長時間にわたる高負荷の下でシステムが安定して動作し続けるかを確認する。

## 負荷テストの種類

1. **負荷テスト（Load Testing）**: 通常の運用を想定した負荷をかけ、システムのパフォーマンスを測定する。
2. **ストレステスト（Stress Testing）**: システムのリソースが限界に達するまで負荷をかけ、システムがどう反応するか確認する。
3. **スパイクテスト（Spike Testing）**: 短時間で急激な負荷の増減をシミュレーションし、システムの反応を確認する。
4. **エンドゥランステスト（Endurance Testing）**: 長時間にわたり持続的な負荷をかけ、システムの長期的な安定性を確認する。
5. **ボリュームテスト（Volume Testing）**: 大量のデータを扱う能力を確認するために、大量のデータをシステムに投入する。

## 負荷テストの手順

1. **テスト計画の策定**:
    - テストの目的と範囲を定義。
    - 測定するパフォーマンス指標（レスポンス時間、スループット、リソース使用率など）を設定。
    - テスト環境とシナリオを設計。

2. **ツールの選定**:
    - 負荷テストを支援するツール（例えば、JMeter、LoadRunner、Gatling、Locustなど）を選定。

3. **テストスクリプトの作成**:
    - 実際のシナリオに基づいてテストスクリプトを作成する。
    - 仮想ユーザーを設定し、システムへのリクエストをシミュレーションする。

4. **テストの実行**:
    - 環境を構築し、テストを実施する。
    - テスト結果をリアルタイムで監視し、必要に応じて調整する。

5. **結果の分析**:
    - テストデータを収集し、パフォーマンス指標を評価する。
    - ボトルネックや問題点を特定し、適切な改善策を講じる。

6. **再テスト**:
    - 改善策を実施した後、再度テストを行い、問題が解消されたことを確認する。

## 負荷テストツール

以下は一般的に使用される負荷テストツールの例

- **Apache JMeter**: オープンソースであり、広範囲に使用されている負荷テストツール。
- **LoadRunner**: 商用ツールであり、大規模な負荷テストに対応。
- **Gatling**: 高性能なシナリオを作成でき、スケーラブルな負荷テストに適している。
- **Locust**: Pythonで記述されており、シナリオをプログラム的に定義可能。

## ベストプラクティス

- **現実に即したシナリオの設計**：本番環境に近い状況でテストを行う。
- **段階的な負荷の増加**：負荷を徐々に増加させ、システムの限界を見つける。
- **リソースモニタリング**：テスト中にシステムリソース（CPU、メモリ、ネットワークなど）を綿密に監視する。
- **繰り返しテスト**：一度のテストだけではなく、複数回のテストを実施し、一貫性のある結果を確認する。

## Tools

- [vegeta](https://github.com/tsenart/vegeta)
- [k6](https://github.com/grafana/k6)
  - grafana内のプロジェクト
