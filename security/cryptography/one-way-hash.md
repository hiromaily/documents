# 一方向ハッシュ関数 / one-way hash function

- 本物である性質のことを`正真性(integrity)` もしくは`完全性`と呼ぶ
- メッセージの指紋をとり、そのファイル等が`改ざんされていない` 本物であることを証明する。具体的にはハッシュ値を比較して`正真性`をを確認する
- 一方向ハッシュ関数が作り出す`ハッシュ値`はメッセージの指紋に相当する
- 一方向ハッシュ関数には`入力メッセージ (message)`、`出力のハッシュ値 (hash value)`があり、メッセージからハッシュ値を計算する
- ハッシュ値の長さは、メッセージの長さとは無関係で、一方向ハッシュ関数は`固定サイズ`のハッシュ値を計算する

## 一方向ハッシュ関数の性質

- 任意長のメッセージから固定長のハッシュ値を計算する
- ハッシュ値を高速に計算できる
- メッセージが異なればハッシュ値も異なる
  - 衝突を見つけることが困難な性質のことを`衝突耐性 (collision resistance)`という
  - そのハッシュ値を持つ別のメッセージを見つけ出すことが非常に困難な性質: `弱衝突耐性`
  - ハッシュ値が一致するような異なる２つのメッセージを見つけ出すことが非常に困難: `強衝突耐性`
- 一方向性を持つ
  - ハッシュ値からメッセージを逆算できないという性質

## 一方向ハッシュ関数に関する用語

### 一方向ハッシュ関数の別名

- メッセージダイジェスト関数
- メッセージ要約関数
- 暗号的ハッシュ関数

### 一方向ハッシュ関数の出力となるハッシュ値

- メッセージダイジェスト
- フィンガープリント

## 一方向ハッシュ関数の応用例

- ソフトウェアの改竄検出
- パスワードを元にした暗号化
- メッセージ認証コード
- デジタル署名
- 擬似乱数生成器
- ワンタイムパスワード

## 一方向ハッシュ関数の具体例

### MD4, MD5

- 128ビットのハッシュ値を持つ
- 強衝突耐性は既に破られており、同じハッシュ値を持つ２つのメッセージを作り出す攻撃が可能になっているため、安全ではない

### RIPEMD-160

- 160ビットのハッシュ値を持つ
- 運用監視暗号リストに入っており、非推奨
- Bitcoinで使われている

### SHA-1

- NISTで作られた
- 160ビットのハッシュ値を持つ
- 運用監視暗号リストに入っており、非推奨

### SHA-2 (SHA-256, SHA-384, SHA-512)

- それぞれ256ビット、384ビット、512ビットのハッシュ値を持つ
- メッセージの長さには上限がある
  - SHA-256の場合、2^64ビット未満 (2.30584301 exabytes)
  - SHA-384, 512の場合、2^128ビット未満
- SHA-2はまだ破られていない

### SHA-3 (KECCAK)

- SHA-2と同様、任意長のビット列を生成できる
  - SHA3-224, SHA3-256, SHA3-384, SHA3-512
- 入力サイズに制限がない
