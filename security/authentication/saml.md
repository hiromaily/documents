# SAML

`Security Assertion Markup Language`

SSO（シングルサインオン）やID連携などで利用される認証情報の規格で、XMLをベースとしたマークアップ言語となる。

## SSO（シングルサインオン）とは

SSO（シングルサインオン/Single Sign-On）とは、一度のログインで、利用したいサービスやシステムすべてにログインできる仕組みのことで、SAML認証によるSSOがよく利用される

## SAMLとOAuthの違い

`OAuth`とは、あらかじめ認可サーバがクライアントアプリケーション側へアクセストークンを発行することで、`認可`を行う仕組み。 SAMLではユーザーを`識別（認証）`するが、OAuthでは行わない。

- `SAML`: `認可`, `認証`とも行う
- `OAuth`: `認可`のみ

## SAML認証の仕組み

- SAML 認証はインターネットドメイン間でユーザー認証を行なうための XML をベースにした認証情報の標準規格
- 一つのアカウント情報を持って複数のサービスで使い回せる `シングルサインオン（SSO）` などに利用される

### SAML認証のフロー: SPを起点とする場合

まず、ユーザーが使いたいサービス（`サービスプロバイダ：SP`）にアクセスすると、SPではユーザーが利用を許可されているアカウントかどうかを確認（認証リクエスト）する。これを受けて、ユーザーは、SAML認証を提供する`IdP（Identity Provider）`に認証依頼を行い、入力したID/パスワードが正しいと判断されれば、`認証トークン`を発行してもらう。ユーザーは、IdPに発行してもらった`認証トークン`をSPに渡す。SPは認証トークンを確認して正規のユーザーであれば認証するという仕組み。

### SAML認証のフロー: IdPを起点とする場合

IdPを起点とした場合は、まず、ユーザーがIdPにアクセスして、認証依頼を行う。ここで入力したID/パスワードが正しいものなら、認証トークンが発行される。次に、ユーザーは利用したいサービス（SP）にアクセスする。すると、SPはIdPから発行された認証トークンを検証し、正規のユーザーであると判断されれば、認証する。
