# tmux ティーマックス

tmux（ターミナルマルチプレクサ）は、端末セッションを管理するためのアプリケーション。これを使うことで、複数の端末ウィンドウとセッションを 1 つの端末内で効率的に管理することができる

tmux は、特に開発者やシステム管理者にとって、セッションとウィンドウ管理をより効率的に行うための強力なツール。セッションの再接続やペイン分割などの機能を活用することで、作業効率を大幅に向上させることができる。

## 基本機能

1. **セッション管理**: tmux はセッションを管理できる。一度セッションを開始すると、端末を閉じてもそのセッションを再開することができる。
2. **ウィンドウ管理**: 各セッションには複数のウィンドウを持てる。各ウィンドウは独自のシェルを保持する。
3. **ペインの分割**: ウィンドウをさらに複数のペインに分割することができる。ペインとは、1 つのウィンドウの中に複数の端末画面を表示する機能。
4. **リモート管理**: リモートサーバーで長時間実行されるプロセスを便利に管理できる。ssh でリモートサーバーに接続して tmux セッションを開始し、切断後に再度接続してもそのセッションを再開可能。
5. **キーバインドのカスタマイズ**: デフォルトのキーバインドは自由にカスタマイズ可能。

## インストール

```sh
# Ubuntu
sudo apt-get install tmux
```

```sh
# MacOS
brew install tmux
```

## 基本的な使い方

1. **セッションの開始**:

   ```sh
   tmux new -s mysession
   ```

   これで新しいセッション名 "mysession" が作成される。

2. **セッションの一覧表示**:

   ```sh
   tmux ls
   ```

3. **セッションへの再接続**:

   ```sh
   tmux attach -t mysession
   ```

4. **セッションのデタッチ**:
   セッションの中で `Ctrl + b` を押してから `d` を押します。これはセッションをバックグラウンドに送る。

5. **ウィンドウの作成**:
   `Ctrl + b` を押してから `c` を押す。

6. **ペインの分割**:

   - 水平方向に分割: `Ctrl + b` を押してから `%` を押す。
   - 垂直方向に分割: `Ctrl + b` を押してから `"` を押す。

7. **ペイン間の移動**:
   `Ctrl + b` を押してから矢印キーを押す。

## 高度な使い方

- **キーバインドのカスタマイズ**: `~/.tmux.conf` ファイルで設定。
- **スクリプト化**: tmux コマンドを使ってスクリプトの中からセッションやウィンドウを自動的に作成。

## iTermsを使っている場合

iTerm2自体がタブ管理やペイン分割、セッションの保存などの機能を持っているため、tmuxと重なる機能がいくつかあるが、tmuxにはiTerm2だけでは得られないいくつかの利点と用途があるため、以下にその比較と必要性について説明する。

### iTerm2の機能

- **タブとペインの管理**: iTerm2はタブとペイン（ペインの垂直・水平分割）をサポートし、一つのウィンドウで複数のシェルを開ける。
- **セッションの保存**: ウィンドウの状態を保存し、後で同じ状態に復元する機能（Session Restore）。
- **Exposéモード**: 複数ウィンドウやタブの間を簡単にナビゲートするための特殊な表示モード。
- **統合検索**: ターミナルバッファ内での文字検索。
- **クリップボード履歴**: 過去にコピーしたテキストの履歴管理。

### tmuxの追加利点

1. **リモートセッション管理**:
   - tmuxはリモートサーバー上でも動作するので、リモートで長時間実行するタスクを管理するのに最適。
   - セッションをデタッチしても、そのセッションを再びアタッチできるので、ネットワークの切断に強い。

2. **持続的セッション**:
   - ローカルでもリモートでも、端末が閉じられてもセッションが保持されるため、再起動後や接続先の変更後でも作業を中断せずに継続できる。

3. **Scriptable(スクリプタブル)な制御**:
   - スクリプトを使ってtmuxセッションやウィンドウ、ペインを管理することが可能。これにより、自動化や再現性を簡単に確保できる。

4. **高度なカスタマイズ**:
   - tmuxは非常に柔軟でカスタマイズが容易です。自身のワークフローに合った設定をtmux構成ファイル（例えば `~/.tmux.conf`）で調整できる。

#### tmuxが必須ではないが、以下の状況においては非常に有用

1. **リモートワークが多い場合**:
   - ssh経由でリモートサーバー上で作業する機会が多い場合、tmuxはセッション管理によって遥かに便利になる。

2. **長時間実行するプロセスがある場合**:
   - ローカルでもリモートでも、一度に多くの作業を行うことが求められる場合、セッションの維持能力が非常に有用。

3. **カスタマイズ性とスクリプタビリティが重要な場合**:
   - 作業環境を高度にカスタマイズしたい場合や、自動化スクリプトを使いたい場合、tmuxはその柔軟性から非常に利便性が高い。

### iTerm2とtmuxを組み合わせて使う

iTerm2とtmuxを組み合わせて使うこともできる。iTerm2にはtmuxとの連携機能があり、tmux統合を有効にするとiTerm2のウィンドウやタブの管理機能をtmuxのセッションとペインに対して活用できる。これにより、両方のツールの利点を最大限に引き出すことができる。
