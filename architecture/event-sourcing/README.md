# イベントソーシング

イベントソーシングとは、データ永続化をドメインオブジェクト(Entity や ValueObject)の状態(ステート)をそのまま保存するのではなく、「ユーザーが登録された」「タスクが完了された」といった イベントそのものを永続化する というアーキテクチャ

## 特徴

- これと対となるのが、ステートソーシング（状態管理）で広く一般的に使われている手法
- 状態はわかるが、状態が変化した理由や経緯が全て失われる
- 履歴やログで記録を取るのには限界がある
- これに対して、イベントソーシングでは、起きたイベントだけを記録していく（状態は記録しない）
- 記録されたイベントを順に再生することで、状態を取得できる。(Bitcoin の残高も同じ)

- メリット
  - ソフトウェアの完全な履歴によって、ある時点を再現できる
- デメリット
  - 最新の状態を得るために毎回膨大なイベントを実行していくのは大変。（つまり高頻度で発生するイベントには向かない)
  - 大量のイベントをさばくのは大変
  - 大量のストレージ容量が必要
  - イベントが変更された場合の互換性問題
- 実装が複雑になりがち
  - イベントをリプレイする機構を実装しなくてはいけない
  - キャッシュや参照系処理への対応など、

## References

[マイクロサービスのための分散データ 〜 イベントソーシング vs チェンジデータキャプチャ](https://rheb.hatenablog.com/entry/2020/02/10/event-sourcing-vs-cdc/)
