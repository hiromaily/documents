# Clean Code

## 前書き

- 小さなことに誠実であることは、決して小さなことではない。小さなことが重要である。
- 神は細部に宿る
- 小さな実践を通じて上達し、大きな実践を通じて信用を勝ち得る
- 日本語の 5S の理念
  - 整理
  - 整頓
  - 清掃
  - 清潔
  - しつけ
- 妥協を許さずにリファクタリングを実施する
- コードを読みやすくする
- 1 つ 1 つの変数名に注意を払う
- 洗練された構造を生み出す能力こそがアーキテクトの領分
- それより広い領域はパターンと、その分野の利用者によるパターンの適用がカバーする
- 細部に没頭するということは、卓越を達成するための共通の努力
- 統計的に見ると、整合性を持った字下げが、バグ発生率を下げるための 1 つの大きな要因である
- アーキテクチャ上の評価基準の 1 つである、凝集度と結合度はコードから得られるもの
- コードをチェックインする前にリファクタリングをするべき
- アーキテクチャもコードを洗練することも、完璧さを求めるわけではなく、正直さと、最善を尽くすことのみを要求する

## 序論

- 職人技の習得は「知識」と「作業」とに分けられる。原則、パターン、実践、経験則といった、職人が身につけるべき知識を得る必要がある。そして実践することで、こうした知識を咀嚼して自分自身に落とし込む必要がある
- クリーンコードを書くことを身につけるには努力が必要で、原則とかパターンといった知識を身につけるだけでは駄目
- 重要なのは、それぞれの経験則の間の関係と、ケーススタディの中でコードを洗練していく過程で行った判断

## 1 章

### そこにコードありき

- 今後、言語の抽象度は増大していき、ドメイン特化言語も増えていくと筆者は予想している

### 粗悪なコード

- リファクタリングしないコードは悪化していき、メンテナンス不能になる

### 混乱のために支払う総コスト

- コードを変更するたびに、コードを 2,3 箇所壊してしまう
- コードの変更や追加のたびに、影響を紐解かねばならない
- 結果、チームの生産性は減少していき、0 に近づいていく
- 途中で基礎設計をやり直す
- スケジュールも大事だが、エンジニアとしてコードのクオリティーを犠牲にするべきではない
- 納期を守るためには、コードを常に、きれいな状態に保つしかない
- きれいなコードを書くには「コードのセンス」が重要

### クリーンコードとは

#### Bjarne Stroustrup

- コードがエレガントで効率がよい
- ロジックはバグが入り込みにくいように単純であるべき
- 依存性は保守が容易となるように最小限にすべき
- エラー処理は一連の戦略に則って完全でなければならない
- 実行効率は最高に近いものでなければならない
- クリーンコードとは 1 つのことをうまくやること
  - 出来の悪いコードは、多くのことをやろうとして、意図がわからなくなって、目的があやふやになってしまう
- 駄目なコードというのは、混乱の拡大を誘惑する
- 壊れた窓理論
  - 建物の窓が壊れていると、そのことについて、誰もきにかけてないと思われてしまい、他の人もそのことに関して注意を払わなくなる
  - これが更なる窓の破壊へとつながり、事態は崩壊へと進み始める
- クリーンコードとは詳細に対して注意を払うということ

#### Grady Booch

- クリーンコードは単純で直接的
- 明快な抽象化と、まっすぐな境界線によって成り立つ
- 読みやすいこと

#### `Big` Dave Thomas

- 原作者以外の人にも読むことができ、拡張できるコード
- 単体テストと受け入れテストが存在する
- 意味を持った名前がある
- 1 つのことをするのに、ただ 1 つの方法を提供する
- 依存性は最低限
- 大きいコードより小さいコード

#### Michael Feathers

- 常に誰かが気配りを持って書いているように見える

#### Ron Jeffries

- 単純なコードである
  - すべてのテストを実行する
  - 重複がない
  - システムのあらゆる設計知識が表現されている
  - クラス、メソッド、関数といったものの数が最低限
- 意味のある名前つけ
- メソッドが 2 つ以上のことをしているなら、メソッド抽出のリファクタリングを行う
- 特定の実装を、抽象化されたメソッドやクラスで包む。これにより実装を簡単に変更できるようになる。
- 後で変更できるという利点を残したまま、素早く開発を先にすすめることができる
- 重複を減らし、表現力を高め、単純な抽象化を早い時期に作り上げる

#### Ward Cunningham

- きれいなプログラムというのは、上手に記述されているため、それに気づくことすらない
- その言語を単純に見せることがプログラマーの責務

### Schools of Thought

- 実際、読むのと書くのとの比率は 10:1 以上になる。コードを新たに書き起こす際には、常に既存のコードを読まなければならない。
- 結局、読みやすくすうということは、書きやすくすることを意味する
- コードを満足に書くには、コードを何度も洗練しなければならない
  - 変数名をよりよいものにし、
  - 大きすぎる関数を分割し、
  - 小さな重複を削除し、
  - if 文の連なりを洗練する
- 時間の経過とともに、コードがよい方向に向かっていく

## 2 章

### 意図が明確な名前にする

- よい名前をつけるのには時間がかかるが、それによって、より多くの時間を節約できる
- 名前をつけるときは注意深く、後でよりよいものが浮かんだら変更する
- 変数、関数、クラス名は、次の大命題に応える必要がある
  - なぜそれが存在するのか
  - 何をするのか
  - どのように使用するのか
- 名前に解説が必要なら、その名前は意図が明確ではない

### 意味のある対比を行う

- info, data ははっきりしない単語なので避ける
- ノイズワード(table, variable, 型情報)は冗長的

### 発音可能な名前を使用する

### 検索可能な名前を用いる

### エンコーディングを避ける

### ハンガリアン記法

- 型情報を名前に埋め込むやり方はやめる

### メンバープレフィクス

- クラス、関数は十分に小さくするもので、メンバープレフィクスは必要ない

### インターフェイスと実装

- インターフェイス名を単純にすること
- `I`を前置きするのは、レガシーコードでは一般的
- インターフェイスか実装のどちらかを名前にエンコードしなければならないなら、実装にする
  - XXXImp, XXXFactory

### メンタルマッピングを避ける

- ループカウンターにつける 1 文字の名前は慣習だから構わないが、これ以外の大半のケースでは 1 文字の名前は避ける

### クラス名

- 名詞あるいは、名詞句を付ける

### メソッド名

- 動詞あるいは、動詞句を付ける

### 気取らない

- おもしろさという価値よりも、明確さのほうが大事

### 1 つのコンセプトには 1 つの単語

### ごろ合わせをしない
