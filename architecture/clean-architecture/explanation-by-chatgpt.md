# Clean Architecture

クリーンアーキテクチャ（Clean Architecture）は、ソフトウェア設計の優れたプラクティスを取り入れたアーキテクチャスタイル。ロバート・C・マーチン（Uncle Bob）によって広められ、彼の著書「Clean Architecture: A Craftsman's Guide to Software Structure and Design」で詳述されている。このアーキテクチャスタイルの主な目標は、システムの`可読性`、`保守性`、`柔軟性`を高めること。

クリーンアーキテクチャは、システムの持続可能性と進化可能性を最大化するための有力なアプローチ。初期段階でこのアーキテクチャを正確に適用することで、将来的な変更や拡張が容易となり、ビジネス価値を迅速に提供する助けとなる。

## クリーンアーキテクチャの基本構造

クリーンアーキテクチャは、いくつかのレイヤーに分かれた同心円状の構造を持つ。内側ほど高レベルの方針やビジネスルールを持ち、外側ほど低レベルの詳細や具体的な実装となる。

### 1. エンティティ（Entities）

- ビジネスルールやエンタープライズ的なルールを包含するレイヤー。
- プロジェクトが取り扱う最も重要な概念やオブジェクトがここに含まれる。
- 他のどのレイヤーからも依存関係を持たない。

### 2. ユースケース（Use Cases）またはインタラクタ（Interactors）

- アプリケーションレベルのビジネスロジックを持つレイヤー。
- エンティティのデータを利用して特定のビジネスルールを達成する。
- エンティティレイヤーにのみ依存する。

### 3. インターフェースアダプター（Interface Adapters）

- 外部の世界とアプリケーションの中核部分を連携させる層。
- ドメインオブジェクトを外部のデータモデルに変換したり、その逆を行ったりする。
- ユーザーインターフェースや API をこのレイヤーに含むことが一般的。

### 4. 外部エージェント（Frameworks & Drivers）

- 最も外側に位置するレイヤーで、データベースや Web フレームワークなど、具体的な技術を扱う。
- 他のレイヤーからの指示に従うだけで、独自のビジネスルールを持つことはない。

## クリーンアーキテクチャの原則

1. **依存関係のルール（Dependency Rule）**:

   - 内側のレイヤーが外側のレイヤーに依存してはいけない。依存関係は常に内側に向いている必要がある。

2. **独立性の確保**:

   - フレームワークに依存しない。
   - User Interface（UI）に依存しない。
   - データベースに依存しない。
   - 外部のエージェントに依存しない。

3. **テストの容易性**:

   - 各レイヤーが明確に分けられており、個別にテストが行いやすくなる。

4. **機能の隔離**:
   - ビジネスルールやユースケースが技術的な詳細から隔離されているため、技術の変更がビジネスロジックに影響を与えない。

## クリーンアーキテクチャのメリット

1. **保守性**:

   - 明確な構造により、コードの変更や追加が容易になる。

2. **柔軟性**:

   - 技術スタックやフレームワークの変更が容易になるため、新しい技術を導入しやすくなる。

3. **テスト容易性**:

   - レイヤーごとに責任範囲が明確に分かれているため、ユニットテストやインテグレーションテストが容易になる。

4. **スケーラビリティ**:
   - アーキテクチャがシステムの複雑化に対応できるため、大規模なプロジェクトでもスケーラブル。

## クリーンアーキテクチャの具体例

クリーンアーキテクチャを理解するために簡単な例を考えます。例えば、タスクリストアプリを作るとする。

1. **エンティティ層**:

   - `Task` クラスや関連ビジネスルールを定義する。

2. **ユースケース層**:

   - `CreateTask` や `CompleteTask` といった具体的なユースケースを実装する。

3. **インターフェースアダプター層**:

   - Web API コントローラーや DTO（データ転送オブジェクト）を実装して、プレゼンテーションとビジネスロジックをつなぐ。

4. **外部エージェント層**:
   - データベースアクセスの実装や、外部 API との統合を行う。
