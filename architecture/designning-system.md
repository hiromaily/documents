# 書籍 システム設計の面接試験 まとめ

## 1. ユーザー数ゼロから数百万人へのスケールアップ

- 単一サーバのセットアップ
- データベース
  - RDB と NoSQL のどちらのデータベースを使うのか
- 垂直スケーリングと水平スケーリング
- ロードバランサ
- データベースレプリケーション
- キャッシュ
  - キャッシュ層
  - キャッシュを使用する際の注意点
- コンテンツデリバリーネットワーク (CDN)
  - CDN を利用する際の注意点
- ステートレス Web 層
  - ステートフルアーキテクチャ
  - ステートレスアーキテクチャ
- データセンター
- メッセージキュー
- ログ取得、定量化、自動化
  - メッセージキューと各種ツールの追加
- データベースのスケーリング
  - 垂直スケーリング
  - 水平スケーリング
- 数百万ユーザーとそれ以上

## 2. おおまかな見積もり

- 2 のべき乗
- プログラマが知っておくべきレイテンシの数値
- 可用性の数値
- 例: Twitter の QPS と必要なストレージの見積もり
- ヒント

## 3. システム設計の面接試験のフレームワーク

- 優れたシステム設計の面接試験の 4 ステップ
  - ステップ 1: 問題を理解し、設計範囲を明確にする
  - ステップ 2: 高度な設計を提案し、賛同を得る
  - ステップ 3: 設計の深掘り
  - ステップ 4: まとめ
- 各ステップの時間配分

## 4. レートリミッターの設計

- ステップ 1: 問題を理解し、設計範囲を明確にする
  - 必要要件
- ステップ 2: 高度な設計を提案し、賛同を得る
  - レートリミッターはどこに置くのか
  - レートリミッターのアルゴリズム
    - トークンバケットアルゴリズム
    - リッキーバケットアルゴリズム
    - 固定ウィンドウカウンタアルゴリズム
    - スライディングウィンドウログアルゴリズム
    - スライディングウィンドウカウンタアルゴリズム
  - 高度なアーキテクチャ
- ステップ 3: 設計の深掘り
  - レート制限ルール
  - レート制限の超過
  - 詳細設計
  - 分散環境におけるレートリミッター
  - 性能の最適化
  - モニタリング
- ステップ 4: まとめ

## 5. コンシステントハッシュの設計

- 再ハッシュ問題
- コンシステントハッシュの設計
  - ハッシュ空間とハッシュリング
  - ハッシュサーバ
  - ハッシュキー
  - サーバの探索
  - サーバの追加
  - 基本的なアプローチにおける 2 つの問題点
  - 仮想ノード
  - 影響を受けるキーの探索
- まとめ

## 6. キーバリューストアの設計

- ステップ 1: 問題を理解し、設計範囲を明確にする
  - 単一サーバのキーバリューストア
  - 分散型キーバリューストア
    - CAP 定理
      - 一貫性
      - 可用性
      - 分断耐性
    - 理想的な状況
    - 実世界の分散システム
    - システム構成要素
    - データの分割
    - データの複製
    - 一貫性
    - 不整合の解消: バージョン管理
    - 障害対応
      - 障害の検出
      - 一時的な障害の対応
      - 恒久的な障害の対応
      - データセンター停止の対応
    - システム構成図
    - 書き込みパス
    - 読み込みパス
- ステップ 4: まとめ

## 7. 分散システムにおけるユニーク ID ジェネレータの設計

- ステップ 1: 問題を理解し、設計範囲を明確にする
- ステップ 2: 高度な設計を提案し、賛同を得る
  - マルチマスターレプリケーション
  - UUID
    - 長所
    - 短所
  - チケットサーバ
    - 長所
    - 短所
  - Twitter による snowflake アプローチ
- ステップ 3: 設計の深掘り
  - タイムスタンプ
  - シーケンス番号
- ステップ 4: まとめ

## 8. URL 短縮サービスの設計

- ステップ 1: 問題を理解し、設計範囲を明確にする
  - おおまかな見積もり
- ステップ 2: 高度な設計を提案し、賛同を得る
  - API エンドポイント
  - URL リダイレクト
  - URL の短縮
- ステップ 3: 設計の深掘り
  - データモデル
  - ハッシュ関数
  - URL 短縮の深掘り
  - URL リダイレクトの深掘り
- ステップ 4: まとめ

## 9. Web クローラの設計

- ステップ 1: 問題を理解し、設計範囲を明確にする
  - おおまかな見積もり
- ステップ 2: 高度な設計を提案し、賛同を得る
  - シード URL
  - URL フロンティア
  - HTML ダウンローダ
  - DNS リゾルバ
  - コンテンツパーサ
  - コンテンツが見られたか
  - コンテンツストレージ
  - URL 抽出機
  - URL フィルタ
  - URL が見られたか
  - URL ストレージ
  - Web クローラのワークフロー
- ステップ 3: 設計の深掘り
  - DFS と BFS の比較
  - URL フロンティア
  - HTML ダウンローダ
  - 堅牢性
  - 拡張性
  - 問題のあるコンテンツの検出と回避
- ステップ 4: まとめ

## 10. 通知システムの設計

## 11. ニュースフィードシステムの設計

## 12. チャットシステムの設計

## 13. 検索オートコンプリートシステムの設計

## 14. YoutTube の設計

## 15. Google ドライブの設計

## 16. 学習は続く
