# Github ActionsによるCronの利用

例えば、定期的にコマンドを実行してファイルを更新して、変更をコミットしてPRを出すというBotを作りたい場合

## GitHub Actionsを使って自動化する方法

1. **リポジトリの準備**:
    - リポジトリに `.github/workflows` ディレクトリを作成する

2. **Workflow ファイルの作成**:
    - 例として `auto-commit-and-pr.yml` ファイルを作成し、以下のように設定する。この例では、特定のスケジュール（例：毎日午前2時に）でコマンドを実行し、その結果をコミットしてPRを作成する。

```yaml
name: Auto Commit and PR

on:
  schedule:
    - cron: '0 2 * * *'  # 毎日午前2時に実行
  
jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Run custom command
      run: |
        # ここで特定のコマンドを実行
        make update-something

    - name: Commit changes
      run: |
        git config --global user.name 'GitHub Action'
        git config --global user.email 'action@github.com'
        git checkout -b bot/automated-new-branch
        git add .
        git commit -m "Auto-commit: changes from custom command"
        git push origin bot/automated-branch
    
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v7
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        branch: automated-branch
        title: 'Automated PR: changes from custom command'
        body: 'This PR is automatically generated by GitHub Actions'
        labels: ['automated-pr']
```

1. **重要なポイント**:
    - `on.schedule` はCron形式でスケジュールを指定する
    - `actions/checkout` はリポジトリのコードをクローンするアクション
    - `peter-evans/create-pull-request` を使ってPRを作成する

以上の設定により、指定したスケジュールでコマンドを実行し、その結果をコミットし、PRを自動で作成するプロセスが実現できる。他にも特定のイベント（push、issueの作成など）をトリガーに設定することも可能。
