# ファジーサーチ / Fuzzy Search

ファジーサーチ（fuzzy search）は情報検索技術の一種で、ユーザーが完全に正確なクエリを提供できない場合でも、関連する結果を提供することを目指している。この技術はテキストデータの検索において、ある程度のあいまいさや誤り（スペルミス、タイプミスなど）を許容することで、より柔軟でユーザーフレンドリーな検索体験を提供する。
ファジーサーチは、データベースや検索エンジンにおける一部の機能として広く使われている技術であり、特にユーザーが入力ミスをする可能性がある場面で強力なツールとなる。

## ファジーサーチの基本コンセプト

### 1. **レーベンシュタイン距離（編集距離）**

- これは二つの文字列間での最小の変換回数（挿入、削除、置換）を測定する方法です。例えば、「kitten」という文字列を「sitting」に変換するために、3 回の操作が必要です（k -> s, e -> i, 追加の g）。
- ファジーサーチでは、レーベンシュタイン距離が小さい結果を優先的に表示します。

### 2. **n グラム**

- 文字列を連続する部分文字列（n-gram）に分解し、それらを比較する方法です。たとえば、3-gram では「weather」という単語は「wea」「eat」「ath」「the」「her」と分解されます。これにより、部分的に一致するテキストも検索可能になります。

### 3. **サウンドエックス**

- 発音が似ている単語を検索するためのアルゴリズムです。例えば、「Smith」と「Smyth」を同じカテゴリに分類するために使用されます。

## ファジーサーチの実装方法

### 1. **Lucene/Solr**

- Apache Lucene や Solr は、強力な全文検索エンジンであり、ファジーサーチをサポートしています。Lucene では、ファジー検索クエリとして`FuzzyQuery`クラスがあります。

```java
Query query = new FuzzyQuery(new Term("fieldName", "searchTerm"), 2); // 最大2つの編集まで許容
```

### 2. **Elasticsearch**

- Elasticsearch もファジーサーチをサポートしており、`fuzzy`クエリを使って実現できます。

```json
{
  "query": {
    "fuzzy": {
      "fieldName": {
        "value": "searchTerm",
        "fuzziness": "AUTO"
      }
    }
  }
}
```

### 3. **SQL**

- SQL でもファジー検索に対応するための拡張があります。例えば、PostgreSQL には`pg_trgm`という拡張があり、トライグラム指数を使用したファジーサーチが可能です。

```sql
SELECT * FROM table WHERE column % 'searchTerm';
```

## ファジーサーチの応用例

- **全文検索エンジン**: ユーザーが正確なスペルを知らなくても関連する結果を検索できるようにする。
- **オートコンプリート機能**: 部分的に入力された単語を補完する。
- **データマッチング&レコードリンク**: 異なるデータソース間で似たレコードを見つける。
