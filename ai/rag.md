# RAG (Retrieval-Augmented Generation、検索拡張生成)

RAG（Retrieval-Augmented Generation、検索拡張生成）は、自然言語処理（NLP）の技術を用いて、大規模言語モデル（LLM）と情報検索エンジンの組み合わせによって、より豊かな情報提供を実現するアプローチ。



## RAG の概要

RAG は、二つの主要な処理ステップで構成されている

1. **情報検索（Retrieval）**: ユーザーのクエリに対して関連する情報を、外部データベース、ドキュメント、知識ベースなどから検索して取得する。
2. **生成（Generation）**: 検索された情報を基に、大規模言語モデルを利用して自然な応答や新しいテキストを生成する。

このアプローチにより、単なる情報の列挙ではなく、コンテクストに適した情報を提供することができる。

## RAGの動作原理

1. **ユーザー入力（クエリ）**:

   - ユーザーは質問やリクエストをシステムに入力。
   - このクエリがエージェントのエントリーポイントとなる。

2. **情報検索モジュール**:

   - クエリを受信したら、まず情報検索モジュールが動作し、外部データソースから関連する情報を検索する。
   - このステップでは、Elasticsearch、BM25、TF-IDF、Dense Retrieval（密なベクトル検索）などの技術が利用される。

3. **情報の前処理**:

   - 検索されたデータは前処理され、ノイズを除去し、言語モデルが扱いやすい形式に変換される。
   - ここでは、トークン化、正規化、重要度計算などが行われる。

4. **言語生成モジュール**:

   - 前処理された情報が大規模言語モデル（たとえば、GPT-3、BERT など）に入力される。
   - このモデルは、ユーザーのクエリと検索結果をコンテキストとして用いて、最適な応答を生成する。

5. **後処理と応答生成**:
   - 言語モデルから生成されたテキストは、必要に応じて後処理され、最終的な応答としてユーザーに提供される。
   - この段階では、テキストのフォーマットや文法チェック、追加の情報補足が行われることがある。

## 技術構成

1. **自然言語処理（NLP）**:

   - **言語モデル**: GPT-3、BERT などの大規模言語モデルが応答生成に利用される。これらのモデルは大量のテキストデータを学習しており、高度な生成能力を持つ。
   - **テキスト処理**: トークン化、ステミング、正規化などのテキスト前処理技術。

2. **情報検索エンジン**:

   - **検索アルゴリズム**: BM25、TF-IDF、Dense Passage Retrieval（DPR）などの情報検索アルゴリズムを使用して、関連する文書や情報を効率良く検索します。
   - **インデキシング技術**: データベースやドキュメントのインデックスを作成し、検索を高速化するための技術。

3. **データ統合および ETL（Extract, Transform, Load）**:

   - 外部データソースからの情報収集、変換、ロードを行い、一貫性と精度を保つためのプロセス。

4. **API およびサービス連携**:

   - RESTful API、GraphQL、SOAP などを用いて外部サービスやデータベースと連携。
   - 情報を取得し、レスポンスを生成するためのインターフェース。

5. **クラウドコンピューティング**:
   - クラウドサービス（AWS、Google Cloud、Azure）を使用して、計算リソースとデータストレージをスケーラブルに利用。

## RAGの応用例

1. **カスタマーサポート**:

   - ユーザーの問い合わせに対して、文脈に応じた適切な応答をリアルタイムで提供。

2. **研究および教育**:

   - 広範なデータベースから情報を検索し、レポートや分析を自動生成。

3. **パーソナルアシスタント**:

   - ユーザーのスケジュール管理、情報検索、リマインダー設定を行う。

4. **メディカル・アシスタント**:

   - 医療専門家が症例に基づく助言を即座に得るために、関連する医学文献やデータベースから情報を取得。

5. **金融アシスタント**:
   - 市場分析、投資助言、金融データの検索と解析を自動化。

## RAGの利点

1. **情報の正確性向上**:

   - 外部データソースを利用することで、最新かつ正確な情報を基に応答を生成。

2. **コンテクスト理解**:

   - 大規模言語モデルのコンテクスト理解能力により、ユーザーの意図に適した応答が可能。

3. **応用の幅広さ**:
   - 多種多様な分野での応用が可能であり、テキスト生成だけでなく情報検索と組み合わせることで、専門的な知識提供も強化。

## RAGの課題

1. **計算コスト**:

   - 大規模言語モデルと情報検索エンジンの組み合わせは高い計算資源を必要とし、コストがかかる。

2. **データの一貫性と品質**:

   - 複数のデータソースを利用する場合、そのデータの一貫性と品質を保つための管理が必要。

3. **プライバシーとセキュリティ**:
   - 特に個人情報や敏感なデータを扱う場合、プライバシーとセキュリティの問題が重要。

### まとめ

RAG（検索拡張生成）は、`自然言語処理`と`情報検索技術`の統合によって、よりインテリジェントかつ文脈に応じた情報提供を実現する手法。これにより、単に情報を提供するだけでなく、高度なコンテクスト理解と生成能力を活用して、質の高い応答が可能となる。これはカスタマーサポート、研究、教育、医療、金融などさまざまな分野での応用が期待されている。

## RAGとAIエージェント比較

1. **対象のタスク**:
   - **RAG**: RAGは主に質問に答える際に外部データベースや文書検索を利用して情報を取得し、それを元に回答を生成する。情報の参照や検索に基づいた回答生成が主要な機能
   - **AIエージェント**: AIエージェントは、人間の指示に基づいて複数のタスクを自動化し、効率化を図るシステム。単純な質問回答だけでなく、複雑な問題解決、実際の作業の遂行（例えば、予約の実行やデータの分析等）まで行う

2. **情報源と情報処理**:
   - **RAG**: RAGは静的なデータベースや文書を主な情報源としている。情報の検索と抽出が中心となる
   - **AIエージェント**: AIエージェントは、複数の動的な情報源を利用する。これにはデータベース、文書、外部API、Web検索、製品仕様などがある。情報の統合と評価済みの回答生成が特徴

3. **自律性**:
   - **RAG**: RAGには自律的な動作はない。主に単一の質問に対する回答を提供する。
   - **AIエージェント**: AIエージェントは自律的な動作が可能で、複数ターンの対話や評価結果のフィードバックを通じて情報を蓄積し、適応する

4. **問題解決**:
   - **RAG**: RAGは基本的な質問に対する直接的な回答を提供するが、複雑な問題解決には対応できないことがある
   - **AIエージェント**: AIエージェントは複雑な問題に対して戦略的な計画と実行を行い、問題解決の能力が優れている

これらの違いから、RAGは主に情報の検索と提供に特化しているが、AIエージェントはより広範なタスクを自動化し、実際の問題解決まで対応することが可能。

## References

- [AWS: RAG (検索拡張生成) とは何ですか?](https://aws.amazon.com/jp/what-is/retrieval-augmented-generation/)
- [2025年はRAGの次にAIエージェントが来る](https://zenn.dev/mixi/articles/c18f4c5e2d84c5)
- [AIエージェントの発展とRAGの新境地、「エージェンティックRAG」が注目される理由](https://ampmedia.jp/2024/12/29/agentic-rag/)
