# JavaScriptがブラウザでどのように動くのか

[参考: JavaScriptがブラウザでどのように動くのか]

## 概要

この記事では、JavaScriptがブラウザでどのように動作するかについて、特にJavaScriptの実行環境やその処理フローに焦点を当てる。

## 主な内容

1. **実行環境の構成**
   - JavaScriptの実行環境は、以下の4つの主要なコンポーネントから成り立っている。
     - JavaScriptエンジン
     - イベントループ
     - Web APIs
     - コールバックキュー

2. **ブラウザごとのコンポーネント比較**
   - 各ブラウザは独自のJavaScriptエンジンとレンダリングエンジンを持っている。以下はその一例。

   | ブラウザ       | JavaScriptエンジン | レンダリングエンジン |
   | -------------- | ------------------ | -------------------- |
   | Chrome, Opera  | V8                 | Blink                |
   | Microsoft Edge | V8                 | Blink                |
   | Firefox        | SpiderMonkey       | Gecko                |
   | Safari         | JavaScriptCore     | WebKit               |

3. **JavaScriptの処理フロー**
   - JavaScriptの処理は以下の順序で行われる。
     1. JavaScriptがコールスタックで実行される。
     2. 非同期関数が呼び出されると、コールバック関数がWeb APIsに送られる。
     3. Web APIsで待機しているコールバック関数が条件を満たすと、コールバックキューに追加される。
     4. コールスタックが空になると、コールバックキューからコールバック関数が実行される。

4. **メモリ管理**
   - JavaScriptエンジンは、スタック領域とヒープ領域の2つのメモリ領域を使用する。
     - **スタック領域**: 固定サイズのメモリ領域で、プリミティブ型や関数の参照が格納される。
     - **ヒープ領域**: 動的サイズのメモリ領域で、オブジェクトや配列が格納される。

5. **コールバックキューとイベントループ**
   - コールバックキューは、次に実行されるべき関数を待機させる場所で、FIFO方式で処理される。
   - イベントループは、コールスタックが空になるたびにコールバックキューからタスクを取り出し、実行する。

6. **非同期処理の例**
   - `setTimeout`関数を使用した非同期処理の流れが説明されている。コールバック関数はWeb APIsに追加され、指定された時間が経過するとコールバックキューに移動する。
