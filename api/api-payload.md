# API payload

API呼び出しを介してネットワーク上で相互接続されたソフトウェア システム間で送信される特定のデータ

## APIの良いデータ設計

データの構造や形式が明確であり、予測しやすく、拡張可能であることを目指す。そのためには以下のポイントが重要となる。

### 1. 直感的でシンプルなデータ構造

データ構造はできるだけ`シンプル`に保ち、`必要最低限の情報`を含める。余計なフィールドや`複雑なネスティングを避ける`ことで、APIの利用者がデータを理解しやすくする。

### 2. 一貫性

データのフォーマットと命名規則を一貫させる。例えば、JSONのキー名にはキャメルケース（例: `userName`）かスネークケース（例: `user_name`）のどちらかに統一する。
JSONにおいては、`キャメルケース（camelCase）`と`スネークケース（snake_case）`がよく使われる。

### 3. 正規化

`データの重複を避け`、必要に応じて正規化を行う。冗長なデータはパフォーマンスの低下とデータの不整合を引き起こす可能性がある。

### 4. 必要な拡張性

将来的な要件変更を見越して、拡張しやすい設計にする。例えば、オプションのフィールドを含む場合は、デフォルトの値を設定するか、存在しない場合の処理を明確にする。

### 5. 適切なデータ型の使用

データ型は適切に選択する。例えば、`日付`は`ISO 8601形式`の文字列（例: `2023-10-03T10:00:00Z`）にする。これにより、タイムゾーンやフォーマットの違いによる混乱を避ける。

### 6. 外部リソースのリンク (これは微妙な気がする)

リソース間の関連性を明示するために、他のリソースへのリンク（hypermedia links）を使用する。例えば、ユーザーリソースが持つ投稿のリストを返す際には、各投稿へのリンクを含める。

```json
{
  "userId": 1,
  "userName": "John Doe",
  "posts": [
    {
      "postId": 101,
      "link": "/posts/101"
    },
    {
      "postId": 102,
      "link": "/posts/102"
    }
  ]
}
```

### 7. バリデーション

入力データと出力データのバリデーションを厳密に行う。これにより、データの整合性を保ち、API利用者が予期しないエラーや不完全なデータに遭遇するリスクを減少させる。

### 8. エラーメッセージの構造化

エラーメッセージは構造化されているべきで、問題の原因と対処方法がわかる形式にする。例えば、エラーメッセージは以下のような形式で提供する。

```json
{
  "error": {
    "code": "INVALID_INPUT",
    "message": "The 'email' field is required",
    "field": "email"
  }
}
```

### 9. 国際化とローカライゼーション

多言語対応が必要な場合、データを国際化する。例えば、ユーザーの表示名や住所などに複数言語対応するためのフィールドを追加する。

### 10. セキュアなデータ設計

機密情報（例: パスワードやトークン）はレスポンスに含めない。また、個人情報の取り扱いには細心の注意を払い、必要に応じてデータの暗号化や匿名化を行う。
